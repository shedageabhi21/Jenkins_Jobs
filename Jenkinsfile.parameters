pipeline {
    agent any

    parameters {
        choice(
            name: 'Env',
            choices: ['dev', 'qa', 'prod'],
            description: 'Select the environment'
        )
        booleanParam(
            name: 'DEPLOY',
            defaultValue: true,
            description: 'Deploy or not'
        )
    }

    stages {
        stage('Build') {
            steps {
                echo "Building for ${params.Env}"
            }
        }

        stage('Deploy') {
            when {
                expression { params.DEPLOY == true }
            }
            steps {
                echo "Deploying to ${params.Env}"
            }
        }
    }

    post {
        success {
            mail to: 'yesboss2112@gmail.com',
                 subject: 'Build Success',
                 body: "Jenkins job completed successfully for ${params.Env}"
        }

        failure {
            mail to: 'yesboss2112@gmail.com',
                 subject: 'Build Failed',
                 body: "Jenkins job failed for ${params.Env}"
        }
    }
}
